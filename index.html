<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>校园生活社交平台</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>校园生活</span>
            </div>
            
            <div class="nav-menu">
                <a href="#" class="nav-link active" data-page="home">
                    <i class="fas fa-home"></i>
                    <span>首页</span>
                </a>
                <a href="#" class="nav-link" data-page="explore">
                    <i class="fas fa-compass"></i>
                    <span>探索</span>
                </a>
                <a href="#" class="nav-link" data-page="publish">
                    <i class="fas fa-plus-circle"></i>
                    <span>发布</span>
                </a>
            </div>
            
            <div class="nav-auth">
                <!-- 登录注册按钮（未登录时显示） -->
                <div class="auth-buttons" id="authButtons">
                    <a href="login.html" class="btn btn-outline">登录</a>
                    <a href="login.html" class="btn btn-primary">注册</a>
                </div>
                
                <!-- 用户菜单（登录后显示） -->
                <div class="user-menu" id="userMenu" style="display: none;">
                    <img src="https://via.placeholder.com/40" alt="头像" class="user-avatar" id="userAvatar" onclick="sessionStorage.removeItem('viewingUserId'); window.location.href='profile.html';" style="cursor: pointer;">
                    <div class="dropdown">
                        <div class="dropdown-content">
                            <a href="profile.html" id="profileLink" onclick="sessionStorage.removeItem('viewingUserId');">
                                <i class="fas fa-user"></i>
                                个人主页
                            </a>
                            <a href="admin.html" id="adminLink" style="display: none;">
                                <i class="fas fa-shield-alt"></i>
                                管理员面板
                            </a>
                            <a href="#" id="logoutBtn" onclick="logout()" class="logout-menu-item">
                                <i class="fas fa-sign-out-alt"></i>
                                退出登录
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主要内容区域 -->
    <main class="main-content">
        <div class="container">
            <!-- 首页内容 -->
            <div class="page-content" id="homePage">
                <div class="content-wrapper">
                    <div class="feed-section">
                        <div class="feed-header">
                            <h2>动态</h2>
                            <div class="feed-filter">
                                <button class="filter-btn active" data-filter="all">全部</button>
                                <button class="filter-btn" data-filter="following">关注</button>
                                <button class="filter-btn" data-filter="hot">热门</button>
                                <button class="filter-btn" data-filter="bookmarked">收藏</button>
                            </div>
                        </div>
                        
                        <div class="posts-container" id="postsContainer">
                            <!-- 动态列表将在这里动态生成 -->
                        </div>
                        
                        
                    </div>
                    
                    <div class="sidebar">
                        <div class="sidebar-section">
                            <h3>热门话题</h3>
                            <div class="trending-topics">
                                <!-- 热门话题将在这里动态生成 -->
                            </div>
                        </div>
                        
                        <div class="sidebar-section">
                            <h3>推荐关注</h3>
                            <div class="recommended-users" id="recommendedUsers">
                                <!-- 推荐用户将在这里动态生成 -->
                            </div>
                        </div>
                        
                        <div class="sidebar-section">
                            <h3>校园公告</h3>
                            <div class="announcements">
                                <div class="announcement-item">
                                    <div class="announcement-title">2025年暑期实习招聘会通知</div>
                                    <div class="announcement-date">2025年6月15日</div>
                                </div>
                                <div class="announcement-item">
                                    <div class="announcement-title">期末考试安排及注意事项</div>
                                    <div class="announcement-date">2025年6月10日</div>
                                </div>
                                <div class="announcement-item">
                                    <div class="announcement-title">毕业典礼活动安排</div>
                                    <div class="announcement-date">2025年6月8日</div>
                                </div>
                                <div class="announcement-item">
                                    <div class="announcement-title">图书馆夏季开放时间调整</div>
                                    <div class="announcement-date">2025年6月5日</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 探索页面 -->
            <div class="page-content" id="explorePage" style="display: none;">
                <div class="explore-header">
                    <h2>探索发现</h2>
                    <div class="explore-search">
                        <input type="text" placeholder="搜索用户、话题..." id="exploreSearch">
                        <button class="search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <div class="explore-categories">
                    <div class="category-card" data-category="study">
                        <i class="fas fa-book"></i>
                        <h3>学习交流</h3>
                        <p>分享学习心得，互相帮助</p>
                    </div>
                    <div class="category-card" data-category="life">
                        <i class="fas fa-heart"></i>
                        <h3>生活分享</h3>
                        <p>记录美好的校园时光</p>
                    </div>
                    <div class="category-card" data-category="activity">
                        <i class="fas fa-users"></i>
                        <h3>社团活动</h3>
                        <p>参与丰富的社团活动</p>
                    </div>
                    <div class="category-card" data-category="sports">
                        <i class="fas fa-running"></i>
                        <h3>运动健身</h3>
                        <p>一起运动，保持健康</p>
                    </div>
                </div>
                
                <div class="explore-results" id="exploreResults">
                    <!-- 搜索结果将在这里显示 -->
                </div>
            </div>
            
            <!-- 发布页面 -->
            <div class="page-content" id="publishPage" style="display: none;">
                <div class="publish-container">
                    <div class="publish-form">
                        <h2>发布动态</h2>
                        
                        <div class="form-group">
                            <textarea id="postContent" placeholder="分享你的想法..." maxlength="500"></textarea>
                            <div class="char-count">
                                <span id="charCount">0</span>/500
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>添加图片</label>
                            <div class="image-upload">
                                <input type="file" id="imageInput" accept="image/*" multiple>
                                <div class="upload-area" id="uploadArea">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>点击或拖拽上传图片</p>
                                </div>
                                <div class="image-preview" id="imagePreview"></div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>话题标签</label>
                            <input type="text" id="topicTags" placeholder="添加话题标签，用空格分隔">
                            <div class="tag-suggestions">
                                <!-- 标签建议将在这里动态生成 -->
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>可见范围</label>
                            <div class="privacy-options">
                                <label class="radio-option">
                                    <input type="radio" name="privacy" value="public" checked>
                                    <span class="radio-custom"></span>
                                    <i class="fas fa-globe"></i>
                                    公开
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="privacy" value="friends">
                                    <span class="radio-custom"></span>
                                    <i class="fas fa-users"></i>
                                    仅好友
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="privacy" value="private">
                                    <span class="radio-custom"></span>
                                    <i class="fas fa-lock"></i>
                                    仅自己
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="saveDraftBtn">保存草稿</button>
                            <button type="button" class="btn btn-primary" id="publishBtn">
                                <i class="fas fa-paper-plane"></i>
                                发布动态
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 消息页面 -->
            <div class="page-content" id="messagesPage" style="display: none;">
                <div class="messages-container">
                    <div class="messages-sidebar">
                        <h3>消息列表</h3>
                        <div class="message-list" id="messageList">
                            <!-- 消息列表将在这里动态生成 -->
                        </div>
                    </div>
                    
                    <div class="message-content">
                        <div class="message-placeholder">
                            <i class="fas fa-comments"></i>
                            <p>选择一个对话开始聊天</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 动态详情模态框 -->
    <div class="modal" id="postDetailModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>动态详情</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="postDetailContent">
                <!-- 动态详情内容将在这里动态生成 -->
            </div>
        </div>
    </div>

    <!-- 通知提示 -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <i class="notification-icon"></i>
            <span class="notification-message"></span>
        </div>
    </div>

    <!-- 加载指示器 -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>加载中...</p>
    </div>

    <!-- JavaScript文件 -->
    <script src="js/app.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/posts.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/social.js"></script>
    <script>
        // 初始化应用
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new CampusLifeApp();
            window.app = app;
            
            // 确保authManager在app中正确设置
            if (app && typeof AuthManager !== 'undefined' && window.authManager) {
                app.authManager = window.authManager;
            }
            
            // 初始化社交管理器
            if (typeof SocialManager !== 'undefined') {
                window.socialManager = new SocialManager();
                // 绑定社交管理器的更新事件
                window.socialManager.init();
            }
            
            // 初始化动态发布管理器
            if (typeof PostManager !== 'undefined') {
                window.postManager = new PostManager();
            }
        });
    </script>
</body>
</html>